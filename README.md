# NAS Playbook

This repository contains an Ansible playbook to transform your RaspberryPi 3 (and most UNIX-based systems like Ubuntu) into a NAS, supporting

* backups
  * encrypted file transfer (SSH)
  * key-based authentication (e.g. [backupnas](https://github.com/sebschlicht/backupnas) for UNIX clients, [FreeFileSync](https://freefilesync.org/) for Windows clients)
  * potentially mirrored to a second location
* flexible [Samba](https://www.samba.org/) shares for maximum compatibility
  * read/write access for UNIX-based, Windows and mobile clients
  * password authentication for users
  * password-free public shares for guests
  * *unencrypted file transfer*
* [DLNA](https://en.wikipedia.org/wiki/Digital_Living_Network_Alliance) access for your smartTV (among many)
  * play videos and/or music on UPnP devices
  * automatic discovery
  * *unencrypted file transfer* (read-only)

## Usage

TBD: change configuration, run playbook, list tags

## Ports

The following ports are open on the NAS and have to be forwarded appropriately when behing a firewall/router:

Application | TCP | UDP
----------- | --- | ---
Samba       | 139, 445 | 137, 138
OpenSSH     | 22  | 

*Note*:
Carefully choose which ports and applications to open in your primary router, open ports always expose applications to the internet!  
Strongly-consider to expose services at non-default ports to avoid the load and risk generated by bots.
You may as well consider to use a VPN instead of exposing these ports.

## Hardening

TODO: move to GitHub wiki

The following steps have been applied in order to harden the NAS:

* harden SSH server
  * RSA public key authentication only
  * no forwarding
  * restricted to the created users

## Issues

TODO: move to GitHub issues

* [add firewall (e.g. `ufw`) together with `fail2ban`](https://www.raspberrypi.org/documentation/configuration/security.md) for users without a router with an integrated firewall
* check log analysis report options
* make Samba read-only, toggle write access via configuration
* (?) integrate with NextCloud to transform system into (backed up) cloud storage
  * Let's Encrypt
    * certificate renewal notification mail
